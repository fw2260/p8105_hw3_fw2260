---
title: "Homework 3"
author: "Lily Wang"
date: "10/4/2020"
output: github_document
---

This is my solution to Homework 3.

```{r setup}
library(tidyverse)
library(p8105.datasets)
```

## Problem 1

Load and clean dataset:

```{r instacart}
data("instacart")
```

The `instacart` dataset contains information on online grocery orders from users of Instacart, an online grocery service that allows you to shop online from local stores. Specifically, there are variables of the IDs of orders, products, and users, when the order was placed, how many days passed since the last order, the name of the products ordered, and what aisle and department they were from. The dataset has `r nrow(instacart)` rows and `r ncol(instacart)` columns.


## Problem 2

```{r clean_accel}
accel_df <- read_csv("./data/accel_data.csv") %>% 
  janitor::clean_names() %>% 
  pivot_longer(
    starts_with("activity_"),
    names_to = "activity",
    names_prefix = "activity_",
    values_to = "counts"
  ) %>% 
  mutate(day = as.factor(day)) %>% 
  mutate(day = fct_relevel(day, c("Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"))) %>% 
  arrange(week, day)
```

The current dataset is accelerometer data of a 63-year-old male who was admitted to the Advanced Cardiac Care Center of Columbia University Medical Center and diagnosed with congestive heart failure (CHF). The accelerometer measures the wearer's activity at each minute of a 24-hour day starting at midnight. The dataset contains `r nrow(accel_df)` rows and `r ncol(accel_df)` columns.

Aggregate across minutes to create a total activity variable for each day:

```{r aggregate_activity}
accel_df %>% 
  group_by(week, day) %>% 
  summarize(
    total_activity = sum(counts)) %>% 
  knitr::kable(digits = 0)
```

There does not seem to be any trends? Let's plot these:

```{r plot_activity}
accel_df %>% 
  ggplot(aes(x = activity, y = counts, color = day)) +
  geom_line() +
  theme(legend.position = "bottom")
```



